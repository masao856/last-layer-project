
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Last Layer - 探索と戦闘（距離制）</title>
  <style>
    body { font-family: sans-serif; background: #000; color: #fff; margin: 0; padding: 0; }
    #backgroundContainer {
      background-size: cover;
      background-position: center;
      width: 100%;
      height: 220px;
    }
    #gameContent {
      padding: 16px;
    }
    #battleLog {
      background: #222;
      padding: 10px;
      height: 140px;
      overflow-y: auto;
      border: 1px solid #555;
      margin-bottom: 10px;
    }
    .log-entry {
      margin: 2px 0; font-size: 0.9em;
    }
    .status-effect {
      display: inline-block;
      background: #444;
      padding: 4px 6px;
      margin: 2px;
      border-radius: 4px;
      font-size: 0.8em;
    }
    #actions button, #exploreButtons button {
      margin-right: 8px; margin-bottom: 4px;
    }
    #enemyImage {
      max-height: 160px;
      margin-bottom: 8px;
    }
    #distanceDisplay {
      margin-bottom: 8px;
      font-size: 1em;
      font-weight: bold;
    }
  </style>
</head>
<body>

<div id="backgroundContainer"></div>

<div id="gameContent">
  <div id="enemyImageContainer">
    <img id="enemyImage" src="" alt="敵画像">
  </div>

  <div id="distanceDisplay">現在地：0m</div>

  <div id="allyStatusUI"></div>
  <div id="enemyStatusUI"></div>
  <div id="battleLog"></div>

  <div id="exploreButtons">
    <button onclick="goForward()">進む</button>
    <button onclick="goBack()">戻る</button>
  </div>

  <div id="actions">
    <button onclick="attack()">攻撃する</button>
    <button onclick="toggleSkillMenu()">スキルを使う</button>
    <button onclick="defend()">防御する</button>
    <button onclick="useItem()">アイテムを使う</button>
  </div>

  <div id="skillMenu" style="display:none; margin-top: 10px;">
    <strong>スキル選択：</strong>
    <select id="skillSelect">
      <option value="ファイアボール">ファイアボール</option>
      <option value="ヒール">ヒール</option>
      <option value="サンダー">サンダー</option>
      <option value="ダークネスウェーブ">ダークネスウェーブ</option>
    </select>
    <button onclick="castSelectedSkill()">発動</button>
  </div>
</div>

<script>
// 現在の進行距離（m）
let currentDistance = 0;

function updateDistanceDisplay() {
  document.getElementById("distanceDisplay").textContent = `現在地：${currentDistance}m`;
}

function setBackgroundImage(filename) {
  document.getElementById("backgroundContainer").style.backgroundImage = `url('images/backgrounds/${filename}')`;
}
function setEnemyImage(filename) {
  document.getElementById("enemyImage").src = `images/enemies/${filename}`;
}

// 探索移動
function goForward() {
  currentDistance += 50;
  updateDistanceDisplay();
  logToBattle(`進んだ。（現在地：${currentDistance}m）`);
  if (currentDistance >= 1000) setBackgroundImage("layer1_a.png");
  setEnemyImage("skeleton_soldier.png");
}
function goBack() {
  currentDistance = Math.max(0, currentDistance - 50);
  updateDistanceDisplay();
  logToBattle(`戻った。（現在地：${currentDistance}m）`);
  if (currentDistance === 0) {
    setBackgroundImage("safe_zone_background.png");
    setEnemyImage("");
  }
}
</script>

</body>
</html>
