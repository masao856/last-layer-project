
<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Last Layer - 敵調整版</title>
  <style>
    body { margin: 0; font-family: sans-serif; background: #000; color: #fff; }
    #backgroundContainer { width: 100%; height: 220px; background-size: cover; background-position: center; }
    #enemyImage { max-height: 160px; margin: 10px auto; display: block; }
    #statusBar, #partyStatus, #commands, #exploreControls { padding: 10px; margin: 10px; background: #111; border: 1px solid #444; }
    #log { background: #222; padding: 10px; margin: 10px; height: 140px; overflow-y: auto; font-size: 0.9em; }
    .button-group button { margin: 4px; }
    .ally { display: inline-block; width: 30%; vertical-align: top; text-align: center; }
  </style>
</head>
<body>

<div id="backgroundContainer"></div>
<img id="enemyImage" src="" alt="敵画像">

<div id="statusBar">
  <div><strong>プレイヤー：</strong> 勇者</div>
  <div>HP: <span id="hp">100</span> / MP: <span id="mp">50</span></div>
</div>

<div id="partyStatus">
  <strong>仲間</strong><br>
  <div class="ally">戦士A<br>HP: 100<br>MP: 20</div>
  <div class="ally">魔法使いB<br>HP: 80<br>MP: 60</div>
</div>

<div id="commands" class="button-group">
  <strong>戦闘コマンド：</strong><br>
  <button>攻撃</button>
  <button>スキル</button>
  <button>防御</button>
  <button>アイテム</button>
</div>

<div id="exploreControls" class="button-group">
  <strong>探索：</strong><br>
  <button onclick="goForward()">進む</button>
  <button onclick="goBack()">戻る</button>
</div>

<div id="log"></div>

<script>
let currentDistance = 0;
document.getElementById("hp").textContent = 100;
document.getElementById("mp").textContent = 50;

function setBackgroundImage(file) {
  document.getElementById("backgroundContainer").style.backgroundImage = `url('images/backgrounds/' + file)`;
}
function setEnemyImage(file) {
  document.getElementById("enemyImage").src = `images/${file}`;
}
function logEvent(text) {
  const log = document.getElementById("log");
  const entry = document.createElement("div");
  entry.textContent = text;
  log.appendChild(entry);
  log.scrollTop = log.scrollHeight;
}

const layerEnemies = {1: ['shadow.png', 'bandit.png', 'beastman_bandit.png', 'zombie.png', 'rotted_rat.png', 'weak_slime.png'], 2: ['enemy_mummy.png', 'skeleton_soldier.png', 'cursed_shadow.png', 'ghost_grave_robber.png', 'enemy_floating_soul.png'], 3: ['sand_snake.png', 'lizardman_sand.png', 'karakara_mummy.png', 'sunamiri_no_mouja.png', 'isekai_no_saikutsusha.png']};
const bossEvents = {500: ['黒鉄の鎧（中ボス）出現', 'armor_knight.png'], 1000: ['堕ちた王（ボス）出現', 'fallen_king.png'], 1250: ['叫びの鎧（中ボス）出現', 'cursed_armor_screaming.png'], 1500: ['墓守の怨霊（ボス）出現', 'gravekeeper_wraith.png'], 3000: ['幻王ザナドゥ（前半ラスボス）出現', 'zanadu.png']};

function getLayer(distance) {
  if (distance < 1000) return 1;
  if (distance < 1500) return 2;
  return 3;
}

function randomEnemyFromLayer(layer) {
  const list = layerEnemies[layer];
  return list[Math.floor(Math.random() * list.length)];
}

function goForward() {
  currentDistance += 50;
  logEvent(`進んだ（${currentDistance}m）`);
  checkScene();
}
function goBack() {
  currentDistance = Math.max(0, currentDistance - 50);
  logEvent(`戻った（${currentDistance}m）`);
  checkScene();
}

function checkScene() {
  if (currentDistance < 1000) setBackgroundImage("fork.png");
  else if (currentDistance < 1500) setBackgroundImage("layer2_a.png");
  else setBackgroundImage("layer3_a.png");

  if (bossEvents[currentDistance]) {
    const [text, image] = bossEvents[currentDistance];
    logEvent(`[ボス] ${text}`);
    setEnemyImage(image);
    return;
  }

  if (Math.random() < 0.25) {
    const layer = getLayer(currentDistance);
    const enemy = randomEnemyFromLayer(layer);
    setEnemyImage(enemy);
    logEvent(`敵が現れた！（${enemy.replace(".png", "")}）`);
  }
}
setBackgroundImage("fork.png");
</script>

</body>
</html>
